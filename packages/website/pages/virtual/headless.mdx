import MdxWrapper from "/components/MdxWrapper";
import CommonHead from "/components/CommonHead";
import Link from "next/link";

## Installation

```bash
# npm
npm i -S @af-utils/react-virtual-headless prop-types use-sync-external-store

# yarn
yarn add @af-utils/react-virtual-headless prop-types use-sync-external-store
```

<h2 id="use-virtual">useVirtual</h2>

```jsx
const model = useVirtual({
    itemCount,
    getEstimatedItemSize,
    overscanCount,
    estimatedWidgetSize,
    horizontal
});
```

### Options

-   `itemCount: Integer`
    -   Defaults to `0`
    -   The total count of elements
-   `getEstimatedItemSize: Function( itemSizes, scrollSize, newItemCount ) => Integer`
    -   Defaults to `scrollSize / itemSizes.length` or `40` if no items
    -   Best-guess item size
-   `overscanCount: Integer`
    -   Defaults to `3`
    -   Minimum amount of items to load behind/ahead(depends on scroll direction) of the current visible range.
-   `horizontal: Boolean`
    -   Defaults to `false`
    -   Determines, whether scrollTop/offsetHeight or scrollLeft/offsetWidth are used in calculations
-   `estimatedWidgetSize: Integer`
    -   Defaults to `200`
    -   Widget size to use before ResizeObserver measurements are ready.
        Used mainly for server-side rendering.
        If you want to disable SSR - put `0` here.

### Returns

-   `itemCount: Integer`
    -   The total count of elements
-   `from: Integer`
    -   range start
-   `to: Integer`
    -   range end
-   `scrollSize: Integer`
    -   sum of all item sizes
-   `getIndex: Function(offset: Integer) => Integer`
-   `getOffset: Function(index: Integer) => Integer`
-   `scrollTo: Function(index: Integer, pixelOffset: Integer ) => void 0`
-   `setOuterNode: Bound Function(el: DOMElement) => void 0`
    -   must be attached to outermost element with `overflow: auto`

## mapVisibleRange

```jsx
mapVisibleRange(model, callback, provideOffset);
```

### Options

-   `model: Model`

    -   **Required**
    -   return value of <Link href="/virtual/headless#use-virtual"><a>`useVirtual()`</a></Link>

-   `callback: Function( currentIndex, offset ) => any`

    -   **Required**

-   `provideOffset: Boolean`

    -   should provide offset or not
    -   Defaults to: false

### Returns

-   `Array<ReactElement>`

<h2 id="numeric-event-constants">Numeric event constants</h2>

-   `EVT_FROM`
-   `EVT_TO`
-   `EVT_SCROLL_SIZE`
-   `EVT_SIZES`
-   `EVT_ALL`_(array of all events)_

## useSubscription

```jsx
useSubscription(model, () => {}, events);
```

### Options

-   `model: Model`
    -   **Required**
    -   return value of `useVirtual()`
-   `callback: Function() => void 0`
    -   **Required**
    -   gets called when at least one of `events` gets triggered
-   `events: Array<Integer>`
    -   **Required**
    -   Array of events to subscribe

## Subscription

```jsx
<Subscription model={model} events={events}>
    {() => {}}
</Subscription>
```

### Options

-   `model: Model`
    -   **Required**
    -   return value of `useVirtual()`
-   `children: Function(index: Integer) => ReactElement`
    -   **Required**
    -   gets called everytime model params change
-   `events: Array<Integer>`
    -   **Required**
    -   Defaults to: <Link href="/virtual/headless#numeric-event-constants"><a>`EVT_ALL`</a></Link>

export default ({ children }) => (
    <MdxWrapper>
        <CommonHead title="Docs:  Headless" />
        {children}
    </MdxWrapper>
);
